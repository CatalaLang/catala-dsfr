<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>File (catala.Catala_utils.File)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">catala</a> &#x00BB; <a href="../index.html">Catala_utils</a> &#x00BB; File</nav><header class="odoc-preamble"><h1>Module <code><span>Catala_utils.File</span></code></h1><p>Utility functions used for file manipulation.</p></header><nav class="odoc-toc"><ul><li><a href="#formatter-wrappers">Formatter wrappers</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec value" id="val-with_out_channel" class="anchored"><a href="#val-with_out_channel" class="anchor"></a><code><span><span class="keyword">val</span> with_out_channel : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="xref-unresolved">Stdlib</span>.out_channel <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Runs the given function with the provided file opened, ensuring it is properly closed afterwards. May raise just as <code>open_out</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_in_channel" class="anchored"><a href="#val-with_in_channel" class="anchor"></a><code><span><span class="keyword">val</span> with_in_channel : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="xref-unresolved">Stdlib</span>.in_channel <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Runs the given function with the provided file opened, ensuring it is properly closed afterwards. May raise just as <code>open_in</code>.</p></div></div><h3 id="formatter-wrappers"><a href="#formatter-wrappers" class="anchor"></a>Formatter wrappers</h3><div class="odoc-spec"><div class="spec value" id="val-with_formatter_of_out_channel" class="anchored"><a href="#val-with_formatter_of_out_channel" class="anchor"></a><code><span><span class="keyword">val</span> with_formatter_of_out_channel : 
  <span><span class="xref-unresolved">Stdlib</span>.out_channel <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_formatter_of_out_channel oc f</code> creates an flushes the formatter used in <code>f</code> from the given out_channel <code>oc</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_formatter_of_file" class="anchored"><a href="#val-with_formatter_of_file" class="anchor"></a><code><span><span class="keyword">val</span> with_formatter_of_file : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_formatter_of_file filename f</code> manages the formatter created from the file <code>filename</code> used in <code>f</code> -- i.e. closes the corresponding out_channel and flushes the formatter.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_formatter_of_opt_file" class="anchored"><a href="#val-with_formatter_of_opt_file" class="anchor"></a><code><span><span class="keyword">val</span> with_formatter_of_opt_file : 
  <span><span>string option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_formatter_of_opt_file filename_opt f</code> manages the formatter created from the file <code>filename_opt</code> if there is some (see <a href="#val-with_formatter_of_file"><code>with_formatter_of_file</code></a>), otherwise, uses the <code>Format.std_formatter</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get_out_channel" class="anchored"><a href="#val-get_out_channel" class="anchor"></a><code><span><span class="keyword">val</span> get_out_channel : 
  <span>source_file:<a href="../Pos/index.html#type-input_file">Pos.input_file</a> <span class="arrow">&#45;&gt;</span></span>
  <span>output_file:<span>string option</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?ext:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>string option</span> * <span>( <span><span>( <span><span class="xref-unresolved">Stdlib</span>.out_channel <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span></span></code></div><div class="spec-doc"><p><code>get_output ~source_file ~output_file ?ext ()</code> returns the infered filename and its corresponding <code>with_out_channel</code> function. If the <code>output_file</code> is equal to <code>Some &quot;-&quot;</code> returns a wrapper around <code>stdout</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get_formatter_of_out_channel" class="anchored"><a href="#val-get_formatter_of_out_channel" class="anchor"></a><code><span><span class="keyword">val</span> get_formatter_of_out_channel : 
  <span>source_file:<a href="../Pos/index.html#type-input_file">Pos.input_file</a> <span class="arrow">&#45;&gt;</span></span>
  <span>output_file:<span>string option</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?ext:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>string option</span> * <span>( <span><span>( <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span></span></code></div><div class="spec-doc"><p><code>get_output_format ~source_file ~output_file ?ext ()</code> returns the infered filename and its corresponding <code>with_formatter_of_out_channel</code> function. If the <code>output_file</code> is equal to <code>Some &quot;-&quot;</code> returns a wrapper around <code>stdout</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-temp_file" class="anchored"><a href="#val-temp_file" class="anchor"></a><code><span><span class="keyword">val</span> temp_file : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Like <code>Filename.temp_file</code>, but registers the file for deletion at program exit unless Cli.debug_flag is set.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_temp_file" class="anchored"><a href="#val-with_temp_file" class="anchor"></a><code><span><span class="keyword">val</span> with_temp_file : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>?contents:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Creates a temp file (with prefix and suffix like <code>temp_file</code>, optionally with the given contents, for the lifetime of the supplied function, then remove it unconditionally</p></div></div><div class="odoc-spec"><div class="spec value" id="val-contents" class="anchored"><a href="#val-contents" class="anchor"></a><code><span><span class="keyword">val</span> contents : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Reads the contents of a file as a string</p></div></div><div class="odoc-spec"><div class="spec value" id="val-process_out" class="anchored"><a href="#val-process_out" class="anchor"></a><code><span><span class="keyword">val</span> process_out : 
  <span>?check_exit:<span>( <span>int <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  string</span></code></div><div class="spec-doc"><p><code>process_out cmd args</code> executes the given command with the specified arguments, and returns the stdout of the process as a string. <code>check_exit</code> is called on the return code of the sub-process, the default is to fail on anything but 0.</p></div></div></div></body></html>
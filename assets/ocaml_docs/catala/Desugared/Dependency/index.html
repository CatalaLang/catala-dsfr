<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dependency (catala.Desugared.Dependency)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">catala</a> &#x00BB; <a href="../index.html">Desugared</a> &#x00BB; Dependency</nav><header class="odoc-preamble"><h1>Module <code><span>Desugared.Dependency</span></code></h1><p>Scope dependencies computations using <a href="http://ocamlgraph.lri.fr/">OCamlgraph</a></p></header><nav class="odoc-toc"><ul><li><a href="#scope-variables-dependency-graph">Scope variables dependency graph</a><ul><li><a href="#graph-declaration">Graph declaration</a></li><li><a href="#graph-computations">Graph computations</a></li></ul></li><li><a href="#exceptions-dependency-graph">Exceptions dependency graph</a></li></ul></nav><div class="odoc-content"><h2 id="scope-variables-dependency-graph"><a href="#scope-variables-dependency-graph" class="anchor"></a>Scope variables dependency graph</h2><h3 id="graph-declaration"><a href="#graph-declaration" class="anchor"></a>Graph declaration</h3><p>Vertices: scope variables or subscopes.</p><p>The vertices of the scope dependency graph are either :</p><ul><li>the variables of the scope ;</li><li>the subscopes of the scope.</li></ul><p>Indeed, during interpretation, subscopes are executed atomically.</p><div class="odoc-spec"><div class="spec module" id="module-Vertex" class="anchored"><a href="#module-Vertex" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Vertex/index.html">Vertex</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Edge" class="anchored"><a href="#module-Edge" class="anchor"></a><code><span><span class="keyword">module</span> Edge</span><span> : <span class="xref-unresolved">Graph</span>.Sig.ORDERED_TYPE_DFT <span class="keyword">with</span> <span><span class="keyword">type</span> <span class="xref-unresolved">t</span> = <span class="xref-unresolved">Catala_utils</span>.Pos.t</span></span></code></div><div class="spec-doc"><p>On the edges, the label is the position of the expression responsible for the use of the variable. In the graph, <code>x -&gt; y</code> if <code>x</code> is used in the definition of <code>y</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-ScopeDependencies" class="anchored"><a href="#module-ScopeDependencies" class="anchor"></a><code><span><span class="keyword">module</span> ScopeDependencies</span><span> : 
  <span class="xref-unresolved">Graph</span>.Sig.P <span class="keyword">with</span> <span><span class="keyword">type</span> <span class="xref-unresolved">V.t</span> = <span class="xref-unresolved">Vertex</span>.t</span> <span class="keyword">and</span> <span><span class="keyword">type</span> <span class="xref-unresolved">E.label</span> = <span class="xref-unresolved">Edge</span>.t</span></span></code></div><div class="spec-doc"><p>Module of the graph, provided by OCamlGraph</p></div></div><h3 id="graph-computations"><a href="#graph-computations" class="anchor"></a>Graph computations</h3><p>Returns an ordering of the scope variables and subscope compatible with the dependencies of the computation</p><div class="odoc-spec"><div class="spec value" id="val-correct_computation_ordering" class="anchored"><a href="#val-correct_computation_ordering" class="anchor"></a><code><span><span class="keyword">val</span> correct_computation_ordering : <span><span class="xref-unresolved">ScopeDependencies</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="Vertex/index.html#type-t">Vertex.t</a> list</span></span></code></div><div class="spec-doc"><p>Returns an ordering of the scope variables and subscope compatible with the dependencies of the computation</p></div></div><div class="odoc-spec"><div class="spec value" id="val-check_for_cycle" class="anchored"><a href="#val-check_for_cycle" class="anchor"></a><code><span><span class="keyword">val</span> check_for_cycle : <span><a href="../Ast/index.html#type-scope">Ast.scope</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">ScopeDependencies</span>.t <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Outputs an error in case of cycles.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-build_scope_dependencies" class="anchored"><a href="#val-build_scope_dependencies" class="anchor"></a><code><span><span class="keyword">val</span> build_scope_dependencies : <span><a href="../Ast/index.html#type-scope">Ast.scope</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">ScopeDependencies</span>.t</span></code></div><div class="spec-doc"><p>Builds the dependency graph of a particular scope</p></div></div><h2 id="exceptions-dependency-graph"><a href="#exceptions-dependency-graph" class="anchor"></a>Exceptions dependency graph</h2><div class="odoc-spec"><div class="spec module" id="module-EdgeExceptions" class="anchored"><a href="#module-EdgeExceptions" class="anchor"></a><code><span><span class="keyword">module</span> EdgeExceptions</span><span> : 
  <span class="xref-unresolved">Graph</span>.Sig.ORDERED_TYPE_DFT <span class="keyword">with</span> <span><span class="keyword">type</span> <span class="xref-unresolved">t</span> = <span><span class="xref-unresolved">Catala_utils</span>.Pos.t <span class="xref-unresolved">list</span></span></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-ExceptionVertex" class="anchored"><a href="#module-ExceptionVertex" class="anchor"></a><code><span><span class="keyword">module</span> <a href="ExceptionVertex/index.html">ExceptionVertex</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-ExceptionsDependencies" class="anchored"><a href="#module-ExceptionsDependencies" class="anchor"></a><code><span><span class="keyword">module</span> ExceptionsDependencies</span><span> : 
  <span class="xref-unresolved">Graph</span>.Sig.P
    <span class="keyword">with</span> <span><span class="keyword">type</span> <span class="xref-unresolved">V.t</span> = <span class="xref-unresolved">ExceptionVertex</span>.t</span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span class="xref-unresolved">E.label</span> = <span class="xref-unresolved">EdgeExceptions</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-build_exceptions_graph" class="anchored"><a href="#val-build_exceptions_graph" class="anchor"></a><code><span><span class="keyword">val</span> build_exceptions_graph : 
  <span><span><a href="../Ast/index.html#type-rule">Ast.rule</a> <a href="../../Shared_ast/RuleName/Map/index.html#type-t">Shared_ast.RuleName.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Ast/ScopeDef/index.html#type-t">Ast.ScopeDef.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">ExceptionsDependencies</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-check_for_exception_cycle" class="anchored"><a href="#val-check_for_exception_cycle" class="anchor"></a><code><span><span class="keyword">val</span> check_for_exception_cycle : 
  <span><span><a href="../Ast/index.html#type-rule">Ast.rule</a> <a href="../../Shared_ast/RuleName/Map/index.html#type-t">Shared_ast.RuleName.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">ExceptionsDependencies</span>.t <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div></div></body></html>
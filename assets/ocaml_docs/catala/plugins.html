<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>plugins (catala.plugins)</title><link rel="stylesheet" href="../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="index.html">Up</a> â€“ <a href="index.html">catala</a> &#x00BB; plugins</nav><header class="odoc-preamble"><h1 id="example-backend-plugins"><a href="#example-backend-plugins" class="anchor"></a>Example backend plugins</h1><p>This directory contains backend plugins that demonstrate how those can be written and used with Catala. They probably don't provide much value otherwise.</p><p>Use <code>make plugins</code> from the root of the source tree to build them.</p><p>A plugin is created by writing an OCaml module that calls <code>Driver.Plugin.register_lcalc</code> or <code>Driver.Plugin.register_scalc</code> and that links against <code>catala.driver</code>. Here is an example dune stanza to compile it:</p><pre>(executable
 (name my-plugin)
 (modes plugin)
 (modules my_plugin_main_module)
 (libraries catala.driver))</pre><p>See the following module for the registration interface:</p><ul class="modules"><li><a href="Driver/Plugin/PluginAPI/index.html"><code>Driver.Plugin</code></a> </li></ul></header><nav class="odoc-toc"><ul><li><a href="#using-plugins">Using plugins</a></li><li><a href="#examples">Examples</a><ul><li><a href="#python-example">python example</a></li><li><a href="#js_of_ocaml-wrapper-generator-example"><code>js_of_ocaml</code> wrapper generator example</a></li><li><a href="#json-schema-generator-example">JSON schema generator example</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="using-plugins"><a href="#using-plugins" class="anchor"></a>Using plugins</h2><p>Plugins are dynamically loaded. The Catala compiler will be looking for them at startup within <code>&lt;prefix&gt;/lib/catala/plugins</code> (assuming that the compiler is installed into <code>&lt;prefix&gt;/bin</code>), or any other directory specified through the `--plugin-dir` command-line flag or by setting the <code>CATALA_PLUGINS</code> environment variable.</p><p>The plugin of your choice can then be called just like the built-in backends, using:</p><pre>$ catala MyPlugin &lt;file&gt; [options]</pre><h2 id="examples"><a href="#examples" class="anchor"></a>Examples</h2><h3 id="python-example"><a href="#python-example" class="anchor"></a>python example</h3><p>This trivial example registers a plugin that uses the <code>scalc</code> format as input. It simply calls the code of the built-in Python backend, and should be no different to using the normal Catala Python output mode.</p><h3 id="js_of_ocaml-wrapper-generator-example"><a href="#js_of_ocaml-wrapper-generator-example" class="anchor"></a><code>js_of_ocaml</code> wrapper generator example</h3><p>This plugin generates a <code>js_of_ocaml</code> wrapper from the <code>lcalc</code> representation of a Catala program.</p><p>It start by generating the OCaml module before generating the <code>_api_web.ml</code> one, which contains all the class types and conversion functions between the OCaml types and their corresponding JS objects. At the end the module exposes all methods in a JS lib <code>&lt;module_name&gt;Lib</code>.</p><p>See <a href="https://github.com/CatalaLang/catala/tree/master/french_law/ocaml/law_source">law_source</a> for examples of generated code.</p><h3 id="json-schema-generator-example"><a href="#json-schema-generator-example" class="anchor"></a>JSON schema generator example</h3><p>This plugin generates a <a href="https://json-schema.org">JSON schema</a> corresponding to a scope of a Catala program.</p><p>See <a href="https://github.com/CatalaLang/catala/tree/master/french_law/json_schemas">json_schemas</a> for examples of generated schemas.</p></div></body></html>